/*!
 * Copyright 2014 Francesco Camarlinghi
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * 	http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;(function(){$.strict=true;var Lifter=this.Lifter=function Lifter(){};var Enumeration=this.Enumeration=function Enumeration(){};Enumeration.fromValue=function(enumeration,value){if(typeof enumeration!=="function"){throw new TypeError(['Invalid enumeration "',enumeration,'".'].join(""));}value=+value||0;var enumKeys=Object.keys(enumeration),enumerator;for(var i=0,n=enumKeys.length;i<n;i++){enumerator=enumeration[enumKeys[i]];if(enumerator.valueOf&&enumerator.valueOf()===value){return enumerator;}}return null;};Enumeration.contains=function(enumeration,value){return Enumeration.fromValue(enumeration,value)!==null;};Enumeration.toArray=function(enumeration){if(typeof enumeration!=="function"){throw new TypeError(['Invalid enumeration "',enumeration,'".'].join(""));}var enumKeys=Object.keys(enumeration),enumKeysLength=enumKeys.length,enumerator,result=[];for(var i=0;i<enumKeysLength;i++){enumerator=enumeration[enumKeys[i]];if(enumerator instanceof Enumerator){result.push(enumerator);}}return result;};var Enumerator=this.Enumerator=function Enumerator(name,value){this.__name=name;this.__value=value;};Enumerator.prototype={toString:function(){return this.__name;},valueOf:function(){return this.__value;},"+":function(operand,rev){return undefined;},"-":function(operand,rev){return undefined;},"*":function(operand,rev){return undefined;},"/":function(operand,rev){return undefined;},"~":function(operand,rev){return undefined;},"===":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()===this.valueOf();},"==":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()==this.valueOf();},"<":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{return this.valueOf()<operand.valueOf();}},"<=":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{if(rev){return this.valueOf()>=operand.valueOf();}else{return this.valueOf()<=operand.valueOf();}}}};var UnitDouble=this.UnitDouble=function UnitDouble(unitType,doubleValue){this.unitType=unitType;this.doubleValue=doubleValue;};UnitDouble.prototype={toString:function(){return this.unitType+" = "+this.doubleValue;},valueOf:function(){return this.doubleValue;},"+":function(operand,rev){return this.doubleValue+operand;},"-":function(operand,rev){return(rev)?operand-this.doubleValue:this.doubleValue-operand;},"*":function(operand,rev){return this.doubleValue*operand;},"/":function(operand,rev){return(rev)?operand/this.doubleValue:this.doubleValue/operand;},"~":function(operand,rev){return undefined;},"===":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()===this.valueOf();},"==":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()==this.valueOf();},"<":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{return this.valueOf()<operand.valueOf();}},"<=":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{if(rev){return this.valueOf()>=operand.valueOf();}else{return this.valueOf()<=operand.valueOf();}}}};var LayerBounds=this.LayerBounds=function LayerBounds(top,left,bottom,right){this.top=new UnitValue(top,"px");this.left=new UnitValue(left,"px");this.bottom=new UnitValue(bottom,"px");this.right=new UnitValue(right,"px");};LayerBounds.prototype={toString:function(){return[this.top,this.left,this.bottom,this.right].join(", ");},valueOf:function(){return undefined;},"+":function(operand,rev){return undefined;},"-":function(operand,rev){return undefined;},"*":function(operand,rev){return undefined;},"/":function(operand,rev){return undefined;},"~":function(operand,rev){return undefined;},"===":function(operand,rev){return(!operand)?false:(operand.top===this.top&&operand.left===this.left&&operand.bottom===this.bottom&&operand.right===this.right);},"==":function(operand,rev){return operand===this;},"<":function(operand,rev){return undefined;},"<=":function(operand,rev){return undefined;}};var LayerType=this.LayerType=function LayerType(){};LayerType.SETSTART=new Enumerator("LayerType.SETSTART",0);LayerType.SETEND=new Enumerator("LayerType.SETEND",1);LayerType.CONTENT=new Enumerator("LayerType.CONTENT",2);var LayerColor=this.LayerColor=function LayerColor(){};LayerColor.NONE=new Enumerator("LayerColor.NONE",charIDToTypeID("None"));LayerColor.RED=new Enumerator("LayerColor.RED",charIDToTypeID("Rd  "));LayerColor.ORANGE=new Enumerator("LayerColor.ORANGE",charIDToTypeID("Orng"));LayerColor.YELLOW=new Enumerator("LayerColor.YELLOW",charIDToTypeID("Ylw "));LayerColor.GREEN=new Enumerator("LayerColor.GREEN",charIDToTypeID("Grn "));LayerColor.BLUE=new Enumerator("LayerColor.BLUE",charIDToTypeID("Bl  "));LayerColor.VIOLET=new Enumerator("LayerColor.VIOLET",charIDToTypeID("Vlt "));LayerColor.GRAY=new Enumerator("LayerColor.GRAY",charIDToTypeID("Gry "));var LifterBlendMode=this.LifterBlendMode=function LifterBlendMode(){};LifterBlendMode.PASSTHROUGH=new Enumerator("LifterBlendMode.PASSTHROUGH",stringIDToTypeID("passThrough"));LifterBlendMode.NORMAL=new Enumerator("LifterBlendMode.NORMAL",charIDToTypeID("Nrml"));LifterBlendMode.DISSOLVE=new Enumerator("LifterBlendMode.DISSOLVE",charIDToTypeID("Dslv"));LifterBlendMode.DARKEN=new Enumerator("LifterBlendMode.DARKEN",charIDToTypeID("Drkn"));LifterBlendMode.MULTIPLY=new Enumerator("LifterBlendMode.MULTIPLY",charIDToTypeID("Mltp"));LifterBlendMode.COLORBURN=new Enumerator("LifterBlendMode.COLORBURN",charIDToTypeID("CBrn"));LifterBlendMode.LINEARBURN=new Enumerator("LifterBlendMode.LINEARBURN",stringIDToTypeID("linearBurn"));LifterBlendMode.DARKERCOLOR=new Enumerator("LifterBlendMode.DARKERCOLOR",stringIDToTypeID("darkerColor"));LifterBlendMode.LIGHTEN=new Enumerator("LifterBlendMode.LIGHTEN",charIDToTypeID("Lghn"));LifterBlendMode.SCREEN=new Enumerator("LifterBlendMode.SCREEN",charIDToTypeID("Scrn"));LifterBlendMode.COLORDODGE=new Enumerator("LifterBlendMode.COLORDODGE",charIDToTypeID("CDdg"));LifterBlendMode.LINEARDODGE=new Enumerator("LifterBlendMode.LINEARDODGE",stringIDToTypeID("linearDodge"));LifterBlendMode.LIGHTERCOLOR=new Enumerator("LifterBlendMode.LIGHTERCOLOR",stringIDToTypeID("lighterColor"));LifterBlendMode.OVERLAY=new Enumerator("LifterBlendMode.OVERLAY",charIDToTypeID("Ovrl"));LifterBlendMode.SOFTLIGHT=new Enumerator("LifterBlendMode.SOFTLIGHT",charIDToTypeID("SftL"));LifterBlendMode.HARDLIGHT=new Enumerator("LifterBlendMode.HARDLIGHT",charIDToTypeID("HrdL"));LifterBlendMode.VIVIDLIGHT=new Enumerator("LifterBlendMode.VIVIDLIGHT",stringIDToTypeID("vividLight"));LifterBlendMode.LINEARLIGHT=new Enumerator("LifterBlendMode.LINEARLIGHT",stringIDToTypeID("linearLight"));LifterBlendMode.PINLIGHT=new Enumerator("LifterBlendMode.PINLIGHT",stringIDToTypeID("pinLight"));LifterBlendMode.HARDMIX=new Enumerator("LifterBlendMode.HARDMIX",stringIDToTypeID("hardMix"));LifterBlendMode.DIFFERENCE=new Enumerator("LifterBlendMode.DIFFERENCE",charIDToTypeID("Dfrn"));LifterBlendMode.EXCLUSION=new Enumerator("LifterBlendMode.EXCLUSION",charIDToTypeID("Xclu"));LifterBlendMode.SUBTRACT=new Enumerator("LifterBlendMode.SUBTRACT",stringIDToTypeID("blendSubtraction"));LifterBlendMode.DIVIDE=new Enumerator("LifterBlendMode.DIVIDE",stringIDToTypeID("blendDivide"));LifterBlendMode.HUE=new Enumerator("LifterBlendMode.HUE",charIDToTypeID("H   "));LifterBlendMode.SATURATION=new Enumerator("LifterBlendMode.SATURATION",charIDToTypeID("Strt"));LifterBlendMode.COLOR=new Enumerator("LifterBlendMode.COLOR",charIDToTypeID("Clr "));LifterBlendMode.LUMINOSITY=new Enumerator("LifterBlendMode.LUMINOSITY",charIDToTypeID("Lmns"));LifterBlendMode.fromBlendMode=function(blendMode){return LifterBlendMode[String(blendMode).replace(/BlendMode\./,"")];};LifterBlendMode.toBlendMode=function(lifterBlendMode){return eval(lifterBlendMode.toString().replace(/LifterBlendMode/,"BlendMode"));};function _ensureLifterBlendMode(blendMode){if(blendMode instanceof Enumerator){return blendMode;}else{return LifterBlendMode.fromBlendMode(blendMode);}}var ApplyImageChannel=this.ApplyImageChannel=function ApplyImageChannel(){};ApplyImageChannel.RGB=new Enumerator("ApplyImageChannel.RGB",charIDToTypeID("RGB "));ApplyImageChannel.Red=new Enumerator("ApplyImageChannel.Red",charIDToTypeID("Rd  "));ApplyImageChannel.Green=new Enumerator("ApplyImageChannel.Green",charIDToTypeID("Grn "));ApplyImageChannel.Blue=new Enumerator("ApplyImageChannel.Blue",charIDToTypeID("Bl  "));var _dialogModesNo=DialogModes.NO;function _getDescriptorProperty(desc,key,type){type||(type=desc.getType(key));switch(type){case DescValueType.ALIASTYPE:return desc.getPath(key);case DescValueType.BOOLEANTYPE:return desc.getBoolean(key);case DescValueType.CLASSTYPE:return desc.getClass(key);case DescValueType.DOUBLETYPE:return desc.getDouble(key);case DescValueType.ENUMERATEDTYPE:return{type:desc.getEnumerationType(key),value:desc.getEnumerationValue(key)};case DescValueType.INTEGERTYPE:return desc.getInteger(key);case DescValueType.LISTTYPE:return desc.getList(key);case DescValueType.OBJECTTYPE:return{type:desc.getObjectType(key),value:desc.getObjectValue(key)};case DescValueType.RAWTYPE:return desc.getData(key);case DescValueType.REFERENCETYPE:return desc.getReference(key);case DescValueType.STRINGTYPE:return desc.getString(key);case DescValueType.UNITDOUBLE:return new UnitDouble(desc.getUnitDoubleType(key),desc.getUnitDoubleValue(key));default:throw new Error(['Unsupported descriptor value type: "',type,'".'].join(""));}}function _getWrappedActionDescriptor(desc,props,id){var fn=function(desc,props,id,name,value){if(!props.hasOwnProperty(name)){throw new Error(['Invalid property: "',name,'".'].join(""));}var prop=props[name];if(typeof value==="undefined"){if(prop.get){return prop.get.call(null,prop,id,desc);}else{return _getDescriptorProperty(desc,prop.typeId,prop.type);}}else{if(!prop.set){throw new Error(['Property "',name,'" is read-only.'].join(""));}prop.set.call(null,prop,id,value);}};return{innerDescriptor:desc,prop:fn.bind(null,desc,props,id)};}function _byteToPercent(value){return(value/255)*100;}function _find(collection,findType,patterns,context){function __match(id){for(var j=0;j<keysLength;j++){if(patterns[keys[j]]!==collection.prop(id,keys[j])){return false;}}found.push(id);return true;}if(typeof patterns!=="function"){if(typeof patterns!=="object"){throw new Error("Search patterns must be either a function or an object.");}var found=[],keys=Object.keys(patterns),keysLength=keys.length;switch(findType){case 2:collection.forEach(function(itemIndex,id){if(__match.call(null,id)){return true;}},null,true);return found.length?found[0]:null;case 1:collection.forEach(function(itemIndex,id){if(__match.call(null,id)){return true;}},null);return found.length?found[0]:null;default:collection.forEach(function(itemIndex,id){__match.call(null,id);},null);return found;}}else{collection.forEach(patterns,context);}}function _ensureFile(file){if(!(file instanceof File)){file=new File(file);}if(!file.exists){throw new Error(['The specified file does not exists: "',file,'".'].join(""));}return file;}Array.prototype.forEach=Array.prototype.forEach||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t){callback.call(context,t[i],i,t);}}};Array.prototype.every=Array.prototype.every||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t&&!callback.call(context,t[i],i,t)){return false;}}return true;};Array.prototype.some=Array.prototype.some||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t&&callback.call(context,t[i],i,t)){return true;}}return false;};Array.prototype.map=Array.prototype.map||function(callback){if(this===void 0||this===null){throw new TypeError();}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var res=new Array(n),context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t){res[i]=callback.call(context,t[i],i,t);}}return res;};Array.prototype.indexOf=Array.prototype.indexOf||function(searchElement){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),length=t.length>>>0,fromIndex=arguments.length>=2?+arguments[1]:0;if(Math.abs(fromIndex)===Infinity){fromIndex=0;}if(fromIndex<0){fromIndex+=length;if(fromIndex<0){fromIndex=0;}}for(;fromIndex<length;fromIndex++){if(t[fromIndex]===searchElement){return fromIndex;}}return -1;};Array.prototype.lastIndexOf=Array.prototype.lastIndexOf||function(searchElement){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined.');}var n,k,t=Object(this),len=t.length>>>0;if(len===0){return -1;}n=len;if(arguments.length>1){n=Number(arguments[1]);if(n!=n){n=0;}else{if(n!=0&&n!=(1/0)&&n!=-(1/0)){n=(n>0||-1)*Math.floor(Math.abs(n));}}}for(k=n>=0?Math.min(n,len-1):len-Math.abs(n);k>=0;k--){if(k in t&&t[k]===searchElement){return k;}}return -1;};Array.prototype.filter=Array.prototype.filter||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!="function"){throw new TypeError("callback must be a function.");}var res=[],context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t){var val=t[i];if(callback.call(context,val,i,t)){res.push(val);}}}return res;};Array.prototype.reduce=Array.prototype.reduce||function(callback){if(this===null||typeof this==="undefined"){throw new TypeError("Array.prototype.reduce called on null or undefined.");}if(typeof callback!=="function"){throw new TypeError(callback+" is not a function");}var t=Object(this),len=t.length>>>0,k=0,value;if(arguments.length>=2){value=arguments[1];}else{while(k<len&&!k in t){k++;}if(k>=len){throw new TypeError("Reduce of empty array with no initial value.");}value=t[k++];}for(;k<len;k++){if(k in t){value=callback(value,t[k],k,t);}}return value;};Array.prototype.reduceRight=Array.prototype.reduceRight||function(callback){if(this===null||typeof this==="undefined"){throw new TypeError("Array.prototype.reduce called on null or undefined.");}if(typeof callback!=="function"){throw new TypeError(callback+" is not a function.");}var t=Object(this),len=t.length>>>0,k=len-1,value;if(arguments.length>=2){value=arguments[1];}else{while(k>=0&&!k in t){k--;}if(k<0){throw new TypeError("Reduce of empty array with no initial value.");}value=t[k--];}for(;k>=0;k--){if(k in t){value=callback(value,t[k],k,t);}}return value;};Object.keys=Object.keys||(function(){var hasOwnProperty=Object.prototype.hasOwnProperty;return function(obj){if(typeof obj!=="object"&&(typeof obj!=="function"||obj===void 0||obj===null)){throw new TypeError("Object.keys called on non-object");}var result=[],prop;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop);}}return result;};}());Function.prototype.bind=Function.prototype.bind||function(){if(typeof this!=="function"){throw new TypeError('"this" is not callable.');}var args=Array.prototype.slice.call(arguments,1),toBind=this,noOp=function(){},bound=function(){return toBind.apply(this instanceof noOp&&oThis?this:oThis,args.concat(Array.prototype.slice.call(arguments)));};noOp.prototype=this.prototype;bound.prototype=new noOp();return bound;};Object.prototype.extend=Object.prototype.extend||function(){if(this===null||typeof this==="undefined"){throw new TypeError("Object.prototype.extend called on null or undefined.");}if(arguments.length===0){return this;}var sources=Array.prototype.slice.call(arguments),source,prop,i,length=sources.length;for(i=0;i<length;i++){source=sources[i];for(prop in source){if(source.hasOwnProperty(prop)){this[prop]=source[prop];}}}};Object.prototype.defaults=Object.prototype.defaults||function(){if(this===null||typeof this==="undefined"){throw new TypeError("Object.prototype.defaults called on null or undefined.");}if(arguments.length===0){return this;}var sources=Array.prototype.slice.call(arguments),source,prop,i,length=sources.length;for(i=0;i<length;i++){source=sources[i];for(prop in source){if(source.hasOwnProperty(prop)&&typeof this[prop]==="undefined"){this[prop]=source[prop];}}}};Object.prototype.clone=function(){var copy={};for(var attr in this){if(typeof this[attr]!=="object"){copy[attr]=this[attr];}else{if(this[attr]===this){copy[attr]=copy;}else{copy[attr]=this[attr].clone();}}}return copy;};Array.prototype.clone=function(){var copy=[];for(var i=0,n=this.length;i<n;i++){if(typeof this[i]!=="object"){copy[i]=this[i];}else{if(this[i]===this){copy[i]=copy;}else{copy[i]=this[i].clone();}}}return copy;};Date.prototype.clone=function(){var copy=new Date();copy.setTime(this.getTime());return copy;};Number.prototype.clone=Boolean.prototype.clone=String.prototype.clone=function(){return this;};(function(){var documents={};var _documentColorModes=[-1,charIDToTypeID("Grsc"),charIDToTypeID("RGBC"),charIDToTypeID("CMYC"),charIDToTypeID("LbCl"),charIDToTypeID("Btmp"),charIDToTypeID("Indl"),charIDToTypeID("Mlth"),charIDToTypeID("Dtn ")];function _wrapSwitchActive(documentId,callback,context){documents.list.makeActive(documentId);callback.call(context);}function _getDocumentIdRef(documentId,ref){if(typeof documentId!=="number"){if(documents.count()===0){throw new Error("Could not target current document: no documents are currently open.");}ref.putEnumerated(charIDToTypeID("Dcmn"),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));}else{ref.putIdentifier(charIDToTypeID("Dcmn"),documentId);}}documents.supportedProperties={itemIndex:{typeId:charIDToTypeID("ItmI"),type:DescValueType.INTEGERTYPE,set:false},documentId:{typeId:charIDToTypeID("DocI"),type:DescValueType.INTEGERTYPE,set:false},width:{typeId:charIDToTypeID("Wdth"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(64,"px"),get:function(prop,documentId,desc){return new UnitValue(desc.getUnitDoubleValue(prop.typeId),"px");},set:false},height:{typeId:charIDToTypeID("Hght"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(64,"px"),get:function(prop,documentId,desc){return new UnitValue(desc.getUnitDoubleValue(prop.typeId),"px");},set:false},resolution:{typeId:charIDToTypeID("Rslt"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(72,"px"),get:function(prop,documentId,desc){return new UnitValue(desc.getUnitDoubleValue(prop.typeId),"px");},set:false},name:{typeId:charIDToTypeID("Ttl "),type:DescValueType.STRINGTYPE,defaultValue:"Untitled",set:false},bitsPerChannel:{typeId:charIDToTypeID("Dpth"),type:DescValueType.INTEGERTYPE,defaultValue:BitsPerChannelType.EIGHT,get:function(prop,documentId,desc){var bitsPerChannel=desc.getInteger(prop.typeId);switch(bitsPerChannel){case 1:return BitsPerChannelType.ONE;case 8:return BitsPerChannelType.EIGHT;case 16:return BitsPerChannelType.SIXTEEN;case 32:return BitsPerChannelType.THIRTYTWO;default:throw new Error("Invalid bit depth: "+bitsPerChannel+".");}}},mode:{typeId:charIDToTypeID("Md  "),type:DescValueType.ENUMERATEDTYPE,defaultValue:DocumentMode.RGB,get:function(prop,documentId,desc){var mode=desc.getEnumerationValue(prop.typeId);switch(mode){case _documentColorModes[1]:return DocumentMode.GRAYSCALE;case _documentColorModes[2]:return DocumentMode.RGB;case _documentColorModes[3]:return DocumentMode.CMYK;case _documentColorModes[4]:return DocumentMode.LAB;case _documentColorModes[5]:return DocumentMode.BITMAP;case _documentColorModes[6]:return DocumentMode.INDEXEDCOLOR;case _documentColorModes[7]:return DocumentMode.MULTICHANNEL;case _documentColorModes[8]:return DocumentMode.DUOTONE;default:throw new Error("Invalid color mode: "+typeIDToCharID(mode)+".");}},set:function(prop,documentId,value){_wrapSwitchActive(documentId,function(){var desc=new ActionDescriptor();if(value===DocumentMode.BITMAP){var desc2=new ActionDescriptor();desc2.putUnitDouble(charIDToTypeID("Rslt"),charIDToTypeID("#Rsl"),documents.prop("resolution"));desc2.putEnumerated(charIDToTypeID("Mthd"),charIDToTypeID("Mthd"),charIDToTypeID("DfnD"));desc.putObject(charIDToTypeID("T   "),charIDToTypeID("BtmM"),desc2);executeAction(charIDToTypeID("CnvM"),desc,_dialogModesNo);}else{var mode;switch(value){case DocumentMode.GRAYSCALE:mode=_documentColorModes[1];case DocumentMode.RGB:mode=_documentColorModes[2];case DocumentMode.CMYK:mode=_documentColorModes[3];case DocumentMode.LAB:mode=_documentColorModes[4];case DocumentMode.BITMAP:mode=_documentColorModes[5];case DocumentMode.INDEXEDCOLOR:mode=_documentColorModes[6];case DocumentMode.MULTICHANNEL:mode=_documentColorModes[7];case DocumentMode.DUOTONE:mode=_documentColorModes[8];default:throw new Error("Invalid color mode: "+value+".");}desc.putClass(charIDToTypeID("T   "),mode);executeAction(charIDToTypeID("CnvM"),desc,_dialogModesNo);}});}},colorProfileName:{typeId:stringIDToTypeID("profile"),type:DescValueType.STRINGTYPE,defaultValue:"sRGB IEC61966-2.1",set:function(prop,documentId,value){_wrapSwitchActive(documentId,function(){var ref=new ActionReference();_getDocumentIdRef(documentId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putString(stringIDToTypeID("profile"),value);executeAction(stringIDToTypeID("assignProfile"),desc,_dialogModesNo);});}},format:{typeId:charIDToTypeID("Fmt "),type:DescValueType.STRINGTYPE,defaultValue:"Photoshop",get:function(prop,documentId,desc){if(!desc.hasKey(prop.typeId)){throw new Error('Unable to get "format". The document needs to be saved before accessing this property.');}return new File(desc.getPath(prop.typeId));},set:false},isDirty:{typeId:charIDToTypeID("IsDr"),type:DescValueType.BOOLEANTYPE,defaultValue:false,set:false},pixelAspectRatio:{typeId:stringIDToTypeID("pixelScaleFactor"),type:DescValueType.UNITDOUBLE,defaultValue:1,set:false},zoom:{typeId:charIDToTypeID("Zm  "),type:DescValueType.UNITDOUBLE,defaultValue:1,set:false},xmpMetadata:{typeId:stringIDToTypeID("XMPMetadataAsUTF8"),type:DescValueType.STRINGTYPE,defaultValue:"",get:function(prop,documentId,desc){var data=desc.getString(prop.typeId);return(typeof XMPMeta==="function")?new XMPMeta(data):data;},set:function(prop,documentId,value){if(typeof value.serialize==="function"){value=value.serialize();}_wrapSwitchActive(documentId,function(){app.activeDocument.xmpMetadata.rawData=value;});}},fullName:{typeId:charIDToTypeID("FilR"),type:DescValueType.ALIASTYPE,defaultValue:null,get:function(prop,documentId,desc){if(!desc.hasKey(prop.typeId)){return null;}else{return new File(desc.getPath(prop.typeId));}},set:false}};documents.count=function(){var ref=new ActionReference();ref.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("NmbD"));ref.putEnumerated(charIDToTypeID("capp"),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));return executeActionGet(ref).getInteger(charIDToTypeID("NmbD"));};documents.getDocumentIdByItemIndex=function(itemIndex){if(typeof itemIndex!=="number"||itemIndex<1){throw new Error(['Invalid itemIndex: "',itemIndex,'".'].join(""));}var ref=new ActionReference();ref.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("DocI"));ref.putIndex(charIDToTypeID("Dcmn"),itemIndex);return executeActionGet(ref).getInteger(charIDToTypeID("DocI"));};documents.add=function(width,height,resolution,name,mode,initialFill,pixelAspectRatio,bitsPerChannel,colorProfileName){app.documents.add(width,height,resolution,name,mode,initialFill,pixelAspectRatio,bitsPerChannel,colorProfileName);return documents;};documents.open=function(file){var desc=new ActionDescriptor();desc.putPath(charIDToTypeID("null"),_ensureFile(file));executeAction(charIDToTypeID("Opn "),desc,_dialogModesNo);return documents;};documents.save=function(saveIn,options,asCopy,extensionType,overwrite){if(documents.count()>0){if(arguments.length===0){app.activeDocument.save();}else{saveIn=_ensureFile(saveIn);if(overwrite===false,saveIn.exists&&documents.prop("fileReference")!==saveIn){throw new Error(['Another file already exists at the specified location: "',saveIn,'".'].join(""));}app.activeDocument.saveAs(_ensureFile(saveIn),options,asCopy,extensionType);}}return documents;};documents.close=function(save){if(documents.count()>0){save||(save=SaveOptions.DONOTSAVECHANGES);app.activeDocument.close(save);}return documents;};documents.forEach=function(callback,context,reverse){if(typeof callback!=="function"){throw new Error("Callback must be a valid function.");}var n,i;if(reverse){i=documents.count()+1;n=0;while(--i>n){if(callback.call(context,i,documents.getDocumentIdByItemIndex(i))){break;}}}else{n=documents.count()+1;i=0;while(++i<n){if(callback.call(context,i,documents.getDocumentIdByItemIndex(i))){break;}}}return documents;};documents.prop=function(){var documentId,name,value,ref,desc;if(typeof arguments[0]==="number"||(!arguments[0]&&arguments.length>1)){documentId=arguments[0];name=arguments[1];value=arguments[2];}else{name=arguments[0];value=arguments[1];}if(typeof name==="undefined"){ref=new ActionReference();_getDocumentIdRef(documentId,ref);desc=executeActionGet(ref);return _getWrappedActionDescriptor(desc,documents.supportedProperties,documentId||desc.getInteger(charIDToTypeID("DocI")));}else{if(!documents.supportedProperties.hasOwnProperty(name)){throw new Error(['Invalid document property: "',name,'".'].join(""));}var prop=documents.supportedProperties[name];if(typeof value==="undefined"){ref=new ActionReference();if(prop.typeId){ref.putProperty(charIDToTypeID("Prpr"),prop.typeId);}_getDocumentIdRef(documentId,ref);desc=executeActionGet(ref);if(prop.get){return prop.get.call(null,prop,documentId,desc);}else{return _getDescriptorProperty(desc,prop.typeId,prop.type);}}else{if(!prop.set){throw new Error(['Property "',name,'" is read-only.'].join(""));}prop.set.call(null,prop,documentId,value);return documents;}}};documents.resizeImage=function(width,height,resolution,resampleMethod,scaleStyles){var originalWidth=documents.prop("width");var originalHeight=documents.prop("height");var originalResolution=documents.prop("resolution");width=typeof width==="number"?new UnitValue(Math.abs(width),"px"):originalWidth;height=typeof height==="number"?new UnitValue(Math.abs(height),"px"):originalHeight;resolution=typeof resolution==="number"?new UnitValue(Math.abs(resolution),"px"):originalResolution;typeof scaleStyles==="boolean"||(scaleStyles=true);if(width===originalWidth&&height===originalHeight&&resolution===originalResolution){return documents;}var desc=new ActionDescriptor();var unit=width.type==="px"?charIDToTypeID("#Pxl"):charIDToTypeID("#Prc");if(width===height&&originalWidth===originalHeight){desc.putUnitDouble(charIDToTypeID("Wdth"),unit,width);desc.putBoolean(charIDToTypeID("CnsP"),true);desc.putBoolean(stringIDToTypeID("scaleStyles"),scaleStyles);}else{desc.putUnitDouble(charIDToTypeID("Wdth"),unit,width);desc.putUnitDouble(charIDToTypeID("Hght"),unit,height);}if(resolution!==originalResolution){desc.putUnitDouble(charIDToTypeID("Rslt"),charIDToTypeID("#Rsl"),resolution);}switch(resampleMethod){case ResampleMethod.NEARESTNEIGHBOR:resampleMethod=stringIDToTypeID("nearestNeighbor");break;case ResampleMethod.BILINEAR:resampleMethod=stringIDToTypeID("bilinear");break;case ResampleMethod.BICUBIC:resampleMethod=stringIDToTypeID("bicubic");break;case ResampleMethod.BICUBICSHARPER:resampleMethod=stringIDToTypeID("bicubicSharper");break;case ResampleMethod.BICUBICSMOOTHER:resampleMethod=stringIDToTypeID("bicubicSmoother");break;default:resampleMethod=stringIDToTypeID("bicubicAutomatic");break;}desc.putEnumerated(charIDToTypeID("Intr"),charIDToTypeID("Intp"),resampleMethod);executeAction(charIDToTypeID("ImgS"),desc,_dialogModesNo);return documents;};documents.duplicate=function(duplicateName,merge){var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Dcmn"),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);if(typeof duplicateName==="string"&&duplicateName.length){desc.putString(charIDToTypeID("Nm  "),duplicateName);}if(merge){desc.putBoolean(charIDToTypeID("Mrgd"),true);}executeAction(charIDToTypeID("Dplc"),desc,_dialogModesNo);return documents;};documents.flatten=function(){executeAction(charIDToTypeID("FltI"),undefined,_dialogModesNo);return documents;};documents.findAll=_find.bind(null,documents,0);documents.findFirst=_find.bind(null,documents,1);documents.findLast=_find.bind(null,documents,2);documents.makeActive=function(documentId){if(typeof documentId!=="number"){throw new Error(["Invalid document identifier: ",documentId,"."].join(""));}var ref=new ActionReference();ref.putIdentifier(charIDToTypeID("Dcmn"),documentId);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);executeAction(charIDToTypeID("slct"),desc,_dialogModesNo);return documents;};documents.getActiveDocumentId=function(){if(documents.count()<1){return -1;}else{return documents.prop("documentId");}};documents.toDOM=function(){if(documents.count()<1){return null;}else{return app.activeDocument;}};Lifter.documents=documents;}());(function(){var layers={};var _cache={};function _wrapSwitchActive(layerId,callback,context){if(layers.prop("layerId")!==layerId){layers.stack.makeActive(layerId);}callback.call(context);}function _getMakeLayerDescriptor(name,opacity,blendMode,color){var desc=new ActionDescriptor();if(typeof name==="string"&&name.length){desc.putString(charIDToTypeID("Nm  "),name);}opacity=+opacity||100;desc.putUnitDouble(charIDToTypeID("Opct"),charIDToTypeID("#Prc"),opacity);(blendMode&&blendMode.valueOf)||(blendMode=BlendMode.NORMAL);desc.putEnumerated(charIDToTypeID("Md  "),charIDToTypeID("BlnM"),_ensureLifterBlendMode(blendMode).valueOf());(color&&color.valueOf)||(color=LayerColor.NONE);desc.putEnumerated(charIDToTypeID("Clr "),charIDToTypeID("Clr "),color.valueOf());return desc;}function _getLayerIdRef(layerId,ref){if(typeof layerId!=="number"||layerId===0){ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));}else{ref.putIdentifier(charIDToTypeID("Lyr "),layerId);}}function _getItemIndexRef(itemIndex,ref){if(typeof itemIndex!=="number"){ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));}else{if(layers.count()===0){if(itemIndex!==1){throw new Error(['Could not find layer with ItemIndex "',itemIndex,'".'].join(""));}ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));}else{if(layers.hasBackground()){itemIndex--;}ref.putIndex(charIDToTypeID("Lyr "),itemIndex);}}return ref;}function _getStackId(direction){if(layers.count()===0){return 0;}else{var ref=new ActionReference();ref.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("LyrI"));ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),direction);return executeActionGet(ref).getInteger(charIDToTypeID("LyrI"));}return layers;}function _traverseStack(direction){if(layers.count()===0){return;}layers.stack.makeActive(_getStackId(direction));return layers;}layers.supportedProperties={itemIndex:{typeId:charIDToTypeID("ItmI"),type:DescValueType.INTEGERTYPE,set:function(prop,layerId,value){if(layers.prop(layerId,"isBackgroundLayer")){throw new Error("Unable to set ItemIndex on background layer.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var ref2=new ActionReference();ref2.putIndex(charIDToTypeID("Lyr "),value);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putReference(charIDToTypeID("T   "),ref2);desc.putBoolean(charIDToTypeID("Adjs"),false);desc.putInteger(charIDToTypeID("Vrsn"),5);executeAction(charIDToTypeID("move"),desc,_dialogModesNo);}},layerId:{typeId:charIDToTypeID("LyrI"),type:DescValueType.INTEGERTYPE,set:false},name:{typeId:charIDToTypeID("Nm  "),type:DescValueType.STRINGTYPE,defaultValue:"Layer",set:function(prop,layerId,value){_wrapSwitchActive(layerId,function(){var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putString(prop.typeId,value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);});}},color:{typeId:charIDToTypeID("Clr "),type:DescValueType.ENUMERATEDTYPE,defaultValue:LayerColor.NONE,get:function(prop,layerId,desc){return Enumeration.fromValue(LayerColor,desc.getEnumerationValue(prop.typeId));},set:function(prop,layerId,value){_wrapSwitchActive(layerId,function(){var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putEnumerated(charIDToTypeID("Clr "),charIDToTypeID("Clr "),value.valueOf());desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);});}},visible:{typeId:charIDToTypeID("Vsbl"),type:DescValueType.BOOLEANTYPE,defaultValue:true,set:function(prop,layerId,value){var ref=new ActionReference();_getLayerIdRef(layerId,ref);var list=new ActionList();list.putReference(ref);var desc=new ActionDescriptor();desc.putList(charIDToTypeID("null"),list);if(value){executeAction(charIDToTypeID("Shw "),desc,_dialogModesNo);}else{executeAction(charIDToTypeID("Hd  "),desc,_dialogModesNo);}}},opacity:{typeId:charIDToTypeID("Opct"),type:DescValueType.UNITDOUBLE,defaultValue:100,get:function(prop,layerId,desc){return _byteToPercent(desc.getInteger(prop.typeId));},set:function(prop,layerId,value){var oldVisible=layers.prop(layerId,"visible");if(!oldVisible){layers.prop(layerId,"visible",true);}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Prc"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);if(!oldVisible){layers.prop(layerId,"visible",false);}}},fillOpacity:{typeId:stringIDToTypeID("fillOpacity"),type:DescValueType.UNITDOUBLE,defaultValue:100,get:function(prop,layerId,desc){return _byteToPercent(desc.getInteger(prop.typeId));},set:function(prop,layerId,value){if(layers.prop(layerId,"type")!==LayerType.CONTENT){throw new Error("Applying fill opacity to layer sets is not supported by Action Manager (nor by DOM).");}var oldVisible=layers.prop(layerId,"visible");if(!oldVisible){layers.prop(layerId,"visible",true);}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Prc"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);if(!oldVisible){layers.prop(layerId,"visible",false);}}},blendMode:{typeId:charIDToTypeID("Md  "),type:DescValueType.ENUMERATEDTYPE,defaultValue:BlendMode.NORMAL,get:function(prop,layerId,desc){return Enumeration.fromValue(LifterBlendMode,desc.getEnumerationValue(prop.typeId));},set:function(prop,layerId,value){value=_ensureLifterBlendMode(value).valueOf();var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putEnumerated(prop.typeId,charIDToTypeID("BlnM"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},type:{typeId:stringIDToTypeID("layerSection"),type:DescValueType.ENUMERATEDTYPE,get:function(prop,layerId,desc){var type=typeIDToStringID(desc.getEnumerationValue(prop.typeId));switch(type){case"layerSectionStart":return LayerType.SETSTART;case"layerSectionEnd":return LayerType.SETEND;case"layerSectionContent":return LayerType.CONTENT;default:throw new Error(['Unsupported layer type encountered: "',type,'".'].join(""));}},set:false},kind:{get:function(prop,layerId,desc){if(layers.prop(layerId,"type")!==LayerType.CONTENT){throw new Error('Unable to get "kind" for layer sets.');}if(desc.hasKey(stringIDToTypeID("textKey"))){return LayerKind.TEXT;}if(desc.hasKey(stringIDToTypeID("smartObject"))){return LayerKind.SMARTOBJECT;}if(desc.hasKey(stringIDToTypeID("layer3D"))){return LayerKind.LAYER3D;}var adjustmentType=stringIDToTypeID("adjustment");if(desc.hasKey(adjustmentType)){var adjustmentKind=typeIDToStringID(desc.getList(adjustmentType).getClass(0));switch(adjustmentKind){case"photoFilter":return LayerKind.PHOTOFILTER;case"solidColorLayer":return LayerKind.SOLIDFILL;case"gradientMapClass":return LayerKind.GRADIENTMAP;case"gradientMapLayer":return LayerKind.GRADIENTFILL;case"hueSaturation":return LayerKind.HUESATURATION;case"colorLookup":return;case"colorBalance":return LayerKind.COLORBALANCE;case"patternLayer":return LayerKind.PATTERNFILL;case"invert":return LayerKind.INVERSION;case"posterization":return LayerKind.POSTERIZE;case"thresholdClassEvent":return LayerKind.THRESHOLD;case"blackAndWhite":return LayerKind.BLACKANDWHITE;case"selectiveColor":return LayerKind.SELECTIVECOLOR;case"vibrance":return LayerKind.VIBRANCE;case"brightnessEvent":return LayerKind.BRIGHTNESSCONTRAST;case"channelMixer":return LayerKind.CHANNELMIXER;case"curves":return LayerKind.CURVES;case"exposure":return LayerKind.EXPOSURE;default:return adjustmentKind;}}return LayerKind.NORMAL;},set:false},bounds:{typeId:stringIDToTypeID("bounds"),type:DescValueType.OBJECTTYPE,get:function(prop,layerId,desc){var bounds=desc.getObjectValue(prop.typeId);return new LayerBounds(bounds.getUnitDoubleValue(charIDToTypeID("Top ")),bounds.getUnitDoubleValue(charIDToTypeID("Left")),bounds.getUnitDoubleValue(charIDToTypeID("Btom")),bounds.getUnitDoubleValue(charIDToTypeID("Rght")),bounds.getUnitDoubleType(charIDToTypeID("Top ")));},set:false},group:{typeId:charIDToTypeID("Grup"),type:DescValueType.BOOLEANTYPE,set:false},hasLayerMask:{typeId:stringIDToTypeID("hasUserMask"),type:DescValueType.BOOLEANTYPE,set:false},layerMaskDensity:{typeId:stringIDToTypeID("userMaskDensity"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(100,"%"),get:function(prop,layerId,desc){if(!layers.prop(layerId,"hasLayerMask")){throw new Error("Unable to get layer mask density: layer does not have a layer mask applied.");}return _byteToPercent(desc.getInteger(prop.typeId));},set:function(prop,layerId,value){if(!layers.prop(layerId,"hasLayerMask")){throw new Error("Unable to set layer mask density: layer does not have a layer mask applied.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Prc"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},layerMaskFeather:{typeId:stringIDToTypeID("userMaskFeather"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(0,"px"),get:function(prop,layerId,desc){if(!layers.prop(layerId,"hasLayerMask")){throw new Error("Unable to get layer mask feather: layer does not have a layer mask applied.");}return desc.getUnitDoubleValue(prop.typeId);},set:function(prop,layerId,value){if(!layers.prop(layerId,"hasLayerMask")){throw new Error("Unable to set layer mask feather: layer does not have a layer mask applied.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Pxl"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},hasVectorMask:{typeId:stringIDToTypeID("hasVectorMask"),type:DescValueType.BOOLEANTYPE,set:false},vectorMaskDensity:{typeId:stringIDToTypeID("vectorMaskDensity"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(100,"%"),get:function(prop,layerId,desc){if(!layers.prop(layerId,"hasVectorMask")){throw new Error("Unable to get vector mask density: layer does not have a vector mask applied.");}return _byteToPercent(desc.getInteger(prop.typeId));},set:function(prop,layerId,value){if(!layers.prop(layerId,"hasVectorMask")){throw new Error("Unable to set vector mask density: layer does not have a vector mask applied.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Prc"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},vectorMaskFeather:{typeId:stringIDToTypeID("vectorMaskFeather"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(0,"px"),get:function(prop,layerId,desc){if(!layers.prop(layerId,"hasVectorMask")){throw new Error("Unable to get vector mask feather: layer does not have a vector mask applied.");}return desc.getUnitDoubleValue(prop.typeId);},set:function(prop,layerId,value){if(!layers.prop(layerId,"hasVectorMask")){throw new Error("Unable to set vector mask feather: layer does not have a vector mask applied.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Pxl"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},hasFilterMask:{typeId:stringIDToTypeID("hasFilterMask"),type:DescValueType.BOOLEANTYPE,set:false},filterMaskDensity:{typeId:stringIDToTypeID("filterMaskDensity"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(100,"%"),get:function(prop,layerId,desc){if(!layers.prop(layerId,"hasFilterMask")){throw new Error("Unable to get filter mask density: layer does not have a filter mask applied.");}return _byteToPercent(desc.getInteger(prop.typeId));},set:function(prop,layerId,value){if(!layers.prop(layerId,"hasFilterMask")){throw new Error("Unable to set filter mask density: layer does not have a filter mask applied.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Prc"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},filterMaskFeather:{typeId:stringIDToTypeID("filterMaskFeather"),type:DescValueType.UNITDOUBLE,defaultValue:new UnitValue(0,"px"),get:function(prop,layerId,desc){if(!layers.prop(layerId,"hasFilterMask")){throw new Error("Unable to get filter mask feather: layer does not have a layer mask applied.");}return desc.getUnitDoubleValue(prop.typeId);},set:function(prop,layerId,value){if(!layers.prop(layerId,"hasFilterMask")){throw new Error("Unable to set filter mask feather: layer does not have a filter mask applied.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var desc2=new ActionDescriptor();desc2.putUnitDouble(prop.typeId,charIDToTypeID("#Pxl"),value);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},allLocked:{typeId:stringIDToTypeID("layerLocking"),type:DescValueType.BOOLEANTYPE,defaultValue:false,get:function(prop,layerId,desc){return desc.getObjectValue(prop.typeId).getBoolean(stringIDToTypeID("protectAll"));},set:function(prop,layerId,value){if(layers.prop(layerId,"isBackgroundLayer")){if(value){throw new Error("Unable to set lock on background layer.");}else{_wrapSwitchActive(layerId,layers.makeLayerFromBackground);}}else{_wrapSwitchActive(layerId,function(){var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var lock=new ActionDescriptor();lock.putBoolean(stringIDToTypeID("protectAll"),value);var desc2=new ActionDescriptor();desc2.putObject(prop.typeId,prop.typeId,lock);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);});}}},pixelsLocked:{typeId:stringIDToTypeID("layerLocking"),type:DescValueType.BOOLEANTYPE,defaultValue:false,get:function(prop,layerId,desc){return desc.getObjectValue(prop.typeId).getBoolean(stringIDToTypeID("protectComposite"));},set:function(prop,layerId,value){if(layers.prop(layerId,"isBackgroundLayer")){throw new Error("Unable to set pixels lock on background layer.");}if(layers.prop(layerId,"type")!==LayerType.CONTENT){throw new Error("Pixels lock can not be set on layer sets.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var lock=new ActionDescriptor();lock.putBoolean(stringIDToTypeID("protectComposite"),value);var desc2=new ActionDescriptor();desc2.putObject(prop.typeId,prop.typeId,lock);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},positionLocked:{typeId:stringIDToTypeID("layerLocking"),type:DescValueType.BOOLEANTYPE,defaultValue:false,get:function(prop,layerId,desc){return desc.getObjectValue(prop.typeId).getBoolean(stringIDToTypeID("protectPosition"));},set:function(prop,layerId,value){if(layers.prop(layerId,"isBackgroundLayer")){throw new Error("Unable to set position lock on background layer.");}if(layers.prop(layerId,"type")!==LayerType.CONTENT){throw new Error("Position lock can not be set on layer sets.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var lock=new ActionDescriptor();lock.putBoolean(stringIDToTypeID("protectPosition"),value);var desc2=new ActionDescriptor();desc2.putObject(prop.typeId,prop.typeId,lock);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},transparentPixelsLocked:{typeId:stringIDToTypeID("layerLocking"),type:DescValueType.BOOLEANTYPE,defaultValue:false,get:function(prop,layerId,desc){return desc.getObjectValue(prop.typeId).getBoolean(stringIDToTypeID("protectTransparency"));},set:function(prop,layerId,value){if(layers.prop(layerId,"isBackgroundLayer")){throw new Error("Unable to set transparency lock on background layer.");}if(layers.prop(layerId,"type")!==LayerType.CONTENT){throw new Error("Transparency lock can not be set on layer sets.");}var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var lock=new ActionDescriptor();lock.putBoolean(stringIDToTypeID("protectTransparency"),value);var desc2=new ActionDescriptor();desc2.putObject(prop.typeId,prop.typeId,lock);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),desc2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);}},isBackgroundLayer:{typeId:charIDToTypeID("Bckg"),type:DescValueType.BOOLEANTYPE,get:function(prop,layerId,desc){return layerId===0||desc.getBoolean(prop.typeId);},set:false},xmpMetadata:{typeId:stringIDToTypeID("metadata"),type:DescValueType.OBJECTTYPE,set:false},lastModified:{typeId:stringIDToTypeID("metadata"),type:DescValueType.DOUBLETYPE,get:function(prop,layerId,desc){var lastModified=new Date();lastModified.setTime(desc.getObjectValue(prop.typeId).getDouble(stringIDToTypeID("layerTime"))*1000);return lastModified;},set:false}};layers.count=function(){if(_cache.hasOwnProperty("layerCount")){return _cache.layerCount;}var ref=new ActionReference();ref.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("NmbL"));ref.putEnumerated(charIDToTypeID("Dcmn"),charIDToTypeID("Ordn"),charIDToTypeID("Trgt"));var count=executeActionGet(ref).getInteger(charIDToTypeID("NmbL"));if(count>0){if(_cache.hasOwnProperty("hasBackground")){if(_cache.hasBackground){count++;}}else{ref=new ActionReference();ref.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("Bckg"));ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Back"));if(executeActionGet(ref).getBoolean(charIDToTypeID("Bckg"))){count++;}}}return count;};layers.getLayerIdByItemIndex=function(itemIndex){var ref=new ActionReference();ref.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("LyrI"));_getItemIndexRef(itemIndex,ref);return executeActionGet(ref).getInteger(charIDToTypeID("LyrI"));};layers.hasBackground=function(){if(_cache.hasOwnProperty("hasBackground")){return _cache.hasBackground;}if(Lifter.layers.count()===0){return true;}else{var ref=new ActionReference();ref.putProperty(charIDToTypeID("Prpr"),charIDToTypeID("Bckg"));ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Back"));return executeActionGet(ref).getBoolean(charIDToTypeID("Bckg"));}};layers.add=function(name,opacity,blendMode,color){var ref=new ActionReference();ref.putClass(charIDToTypeID("Lyr "));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putObject(charIDToTypeID("Usng"),charIDToTypeID("Lyr "),_getMakeLayerDescriptor(name,opacity,blendMode,color));executeAction(charIDToTypeID("Mk  "),desc,_dialogModesNo);return layers;};layers.addLayerSet=function(name,opacity,blendMode,color){var ref=new ActionReference();ref.putClass(stringIDToTypeID("layerSection"));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putObject(charIDToTypeID("Usng"),stringIDToTypeID("layerSection"),_getMakeLayerDescriptor(name,opacity,blendMode,color));executeAction(charIDToTypeID("Mk  "),desc,_dialogModesNo);return layers;};layers.remove=function(layerId){var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);executeAction(charIDToTypeID("Dlt "),desc,_dialogModesNo);return layers;};layers.makeLayerFromBackground=function(name,opacity,blendMode,color){if(!Lifter.layers.hasBackground()){return;}var ref=new ActionReference();ref.putProperty(charIDToTypeID("Lyr "),charIDToTypeID("Bckg"));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putObject(charIDToTypeID("T   "),charIDToTypeID("Lyr "),_getMakeLayerDescriptor(name,opacity,blendMode,color));executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);};layers.convertToSmartObject=function(layerId){if(typeof layerId==="number"){layers.stack.makeActive(layerId);}executeAction(stringIDToTypeID("newPlacedLayer"),undefined,_dialogModesNo);return layers;};layers.duplicate=function(layerId,documentId){var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);if(documentId){var ref2=new ActionReference();ref.putIdentifier(charIDToTypeID("Dcmn"),documentId);desc.putReference(charIDToTypeID("T   "),ref2);}desc.putInteger(charIDToTypeID("Vrsn"),5);executeAction(charIDToTypeID("Dplc"),desc,_dialogModesNo);return layers;};layers.applyImage=function(sourceDocumentId,sourceLayerId,sourceChannel,invert,blendMode,opacity){if(!Lifter.documents){throw new Error("Lifter.layers.applyImage requires the Lifter.documents library.");}if(typeof sourceDocumentId!=="number"){sourceDocumentId=Lifter.documents.getActiveDocumentId();}if(sourceLayerId!=="merged"&&typeof sourceLayerId!=="number"){sourceLayerId=layers.stack.getActiveLayerId();}if(sourceChannel){if(!Enumeration.contains(ApplyImageChannel,sourceChannel)){throw new TypeError("Invalid sourceChannel:"+sourceChannel);}}else{sourceChannel=ApplyImageChannel.RGB;}typeof invert==="boolean"||(invert=false);(blendMode&&blendMode.valueOf)||(blendMode=LifterBlendMode.NORMAL);blendMode=_ensureLifterBlendMode(blendMode);opacity=+opacity||100;var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Chnl"),charIDToTypeID("Chnl"),sourceChannel.valueOf());if(sourceLayerId==="merged"){ref.putEnumerated(charIDToTypeID("Lyr "),charIDToTypeID("Ordn"),charIDToTypeID("Mrgd"));}else{var activeDocId=Lifter.documents.getActiveDocumentId();Lifter.documents.makeActive(sourceDocId);if(layers.prop("isBackgroundLayer")){ref.putProperty(charIDToTypeID("Lyr "),charIDToTypeID("Bckg"));}else{ref.putIdentifier(charIDToTypeID("Lyr "),sourceLayerId);}Lifter.documents.makeActive(activeDocId);}ref.putIdentifier(charIDToTypeID("Dcmn"),sourceDocumentId);var desc2=new ActionDescriptor();desc2.putReference(charIDToTypeID("T   "),ref);desc2.putEnumerated(charIDToTypeID("Clcl"),charIDToTypeID("Clcn"),blendMode.valueOf());desc2.putUnitDouble(charIDToTypeID("Opct"),charIDToTypeID("#Prc"),opacity);desc2.putBoolean(charIDToTypeID("PrsT"),true);desc2.putBoolean(charIDToTypeID("Invr"),invert);var desc=new ActionDescriptor();desc.putObject(charIDToTypeID("With"),charIDToTypeID("Clcl"),desc2);executeAction(charIDToTypeID("AppI"),desc,_dialogModesNo);return layers;};layers.invert=function(layerId){if(typeof layerId==="number"){layers.stack.makeActive(layerId);}executeAction(charIDToTypeID("Invr"),undefined,_dialogModesNo);return layers;};layers.forEach=function(callback,context,reverse){if(typeof callback!=="function"){throw new Error("Callback must be a valid function.");}var n,i;_cache.hasBackground=layers.hasBackground();_cache.layerCount=layers.count();if(reverse){i=_cache.layerCount+1;n=0;while(--i>n){if(callback.call(context,i,layers.getLayerIdByItemIndex(i))){break;}}}else{n=_cache.layerCount+1;i=0;while(++i<n){if(callback.call(context,i,layers.getLayerIdByItemIndex(i))){break;}}}delete _cache.hasBackground;delete _cache.layerCount;return layers;};layers.prop=function(){var layerId,name,value,ref,desc;if(typeof arguments[0]==="number"||(!arguments[0]&&arguments.length>1)){layerId=arguments[0];name=arguments[1];value=arguments[2];}else{name=arguments[0];value=arguments[1];}if(typeof name==="undefined"){ref=new ActionReference();_getLayerIdRef(layerId,ref);desc=executeActionGet(ref);return _getWrappedActionDescriptor(desc,layers.supportedProperties,layerId||desc.getInteger(charIDToTypeID("LyrI")));}else{if(!layers.supportedProperties.hasOwnProperty(name)){throw new Error(['Invalid layer property: "',name,'".'].join(""));}var prop=layers.supportedProperties[name];if(typeof value==="undefined"){ref=new ActionReference();if(prop.typeId){ref.putProperty(charIDToTypeID("Prpr"),prop.typeId);}_getLayerIdRef(layerId,ref);desc=executeActionGet(ref);if(prop.get){return prop.get.call(null,prop,layerId,desc);}else{return _getDescriptorProperty(desc,prop.typeId,prop.type);}}else{if(!prop.set){throw new Error(['Property "',name,'" is read-only.'].join(""));}if(layers.prop(layerId,"type")===LayerType.SETEND){throw new Error(["Setting properties on a layer of type ",LayerType.SETEND.toString()," is not supported."].join(""));}prop.set.call(null,prop,layerId,value);return layers;}}};layers.findAll=_find.bind(null,layers,0);layers.findFirst=_find.bind(null,layers,1);layers.findLast=_find.bind(null,layers,2);layers.stack={};layers.stack.getActiveLayerId=function(){return layers.prop("layerId");};layers.stack.getFrontLayerId=_getStackId.bind(null,charIDToTypeID("Frnt"));layers.stack.getBottomLayerId=_getStackId.bind(null,charIDToTypeID("Back"));layers.stack.getNextLayerId=_getStackId.bind(null,charIDToTypeID("Frwr"));layers.stack.getPreviousLayerId=_getStackId.bind(null,charIDToTypeID("Bckw"));layers.stack.makeActive=function(layerId,makeVisible){if(typeof layerId!=="number"||layerId<1){throw new Error("Invalid layerId: "+layerId);}typeof makeVisible==="boolean"||(makeVisible=false);var ref=new ActionReference();ref.putIdentifier(charIDToTypeID("Lyr "),layerId);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putBoolean(charIDToTypeID("MkVs"),makeVisible);executeAction(charIDToTypeID("slct"),desc,_dialogModesNo);return layers;};layers.stack.makeFrontActive=_traverseStack.bind(null,charIDToTypeID("Frnt"));layers.stack.makeBottomActive=_traverseStack.bind(null,charIDToTypeID("Back"));layers.stack.makeNextActive=_traverseStack.bind(null,charIDToTypeID("Frwr"));layers.stack.makePreviousActive=_traverseStack.bind(null,charIDToTypeID("Bckw"));layers.masks={};layers.masks.addLayerMask=function(layerId){if(layers.prop(layerId,"hasLayerMask")){throw new Error("Unable to add layer mask: layer already has one.");}if(layers.prop(layerId,"isBackgroundLayer")){layers.makeLayerFromBackground();}layers.stack.makeActive(layerId);var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Chnl"),charIDToTypeID("Chnl"),charIDToTypeID("Msk "));var desc=new ActionDescriptor();desc.putClass(charIDToTypeID("Nw  "),charIDToTypeID("Chnl"));desc.putReference(charIDToTypeID("At  "),ref);desc.putEnumerated(charIDToTypeID("Usng"),charIDToTypeID("UsrM"),charIDToTypeID("RvlA"));executeAction(charIDToTypeID("Mk  "),desc,_dialogModesNo);return layers;};layers.masks.addVectorMask=function(layerId){if(layers.prop(layerId,"hasVectorMask")){throw new Error("Unable to add vector mask: layer already has one.");}if(layers.prop(layerId,"isBackgroundLayer")){layers.makeLayerFromBackground();}layers.stack.makeActive(layerId);var ref=new ActionReference();ref.putClass(charIDToTypeID("Path"));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);var ref2=new ActionReference();ref2.putEnumerated(charIDToTypeID("Path"),charIDToTypeID("Path"),stringIDToTypeID("vectorMask"));desc.putReference(charIDToTypeID("At  "),ref2);desc.putEnumerated(charIDToTypeID("Usng"),stringIDToTypeID("vectorMaskEnabled"),charIDToTypeID("RvlA"));executeAction(charIDToTypeID("Mk  "),desc,_dialogModesNo);return layers;};layers.masks.removeLayerMask=function(){var layerId,apply;if(typeof arguments[0]==="number"){layerId=arguments[0];apply=arguments[1]||false;}else{apply=arguments[0]||false;}var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Chnl"),charIDToTypeID("Chnl"),charIDToTypeID("Msk "));_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putBoolean(charIDToTypeID("Aply"),apply);executeAction(charIDToTypeID("Dlt "),desc,_dialogModesNo);return layers;};layers.masks.removeVectorMask=function(layerId){var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Path"),charIDToTypeID("Path"),stringIDToTypeID("vectorMask"));_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);executeAction(charIDToTypeID("Dlt "),desc,_dialogModesNo);return layers;};layers.masks.refineLayerMask=function(layerId,edgeBorderRadius,edgeBorderContrast,edgeSmooth,edgeFeatherRadius,edgeChoke,edgeAutoRadius,edgeDecontaminate){typeof edgeBorderRadius==="number"||(edgeBorderRadius=0);typeof edgeBorderContrast==="number"||(edgeBorderContrast=0);typeof edgeSmooth==="number"||(edgeSmooth=0);typeof edgeFeatherRadius==="number"||(edgeFeatherRadius=0);typeof edgeChoke==="number"||(edgeChoke=0);typeof edgeAutoRadius==="boolean"||(edgeAutoRadius=false);typeof edgeDecontaminate==="boolean"||(edgeDecontaminate=false);var ref=new ActionReference();_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putUnitDouble(stringIDToTypeID("refineEdgeBorderRadius"),charIDToTypeID("#Pxl"),Math.abs(edgeBorderRadius));desc.putUnitDouble(stringIDToTypeID("refineEdgeBorderContrast"),idPrc,Math.abs(edgeBorderContrast));desc.putInteger(stringIDToTypeID("refineEdgeSmooth"),Math.abs(Math.ceil(edgeSmooth)));desc.putUnitDouble(stringIDToTypeID("refineEdgeFeatherRadius"),charIDToTypeID("#Pxl"),Math.abs(edgeFeatherRadius));desc.putUnitDouble(stringIDToTypeID("refineEdgeChoke"),charIDToTypeID("#Prc"),Math.abs(edgeChoke));desc.putBoolean(stringIDToTypeID("refineEdgeAutoRadius"),edgeAutoRadius);desc.putBoolean(stringIDToTypeID("refineEdgeDecontaminate"),edgeDecontaminate);desc.putEnumerated(stringIDToTypeID("refineEdgeOutput"),stringIDToTypeID("refineEdgeOutput"),stringIDToTypeID("refineEdgeOutputUserMask"));executeAction(stringIDToTypeID("refineSelectionEdge"),desc,_dialogModesNo);return layers;};layers.masks.makeLayerMaskActive=function(){var layerId,makeVisible;if(typeof arguments[0]==="number"){layerId=arguments[0];makeVisible=arguments[1]||false;}else{makeVisible=arguments[0]||false;}var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Chnl"),charIDToTypeID("Chnl"),charIDToTypeID("Msk "));_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putBoolean(charIDToTypeID("MkVs"),makeVisible?true:false);executeAction(charIDToTypeID("slct"),desc,_dialogModesNo);return layers;};layers.masks.makeVectorMaskActive=function(){var layerId,active,ref,desc;if(typeof arguments[0]==="number"){layerId=arguments[0];active=arguments[1]||false;}else{active=arguments[0]||false;}if(active){ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Path"),charIDToTypeID("Path"),stringIDToTypeID("vectorMask"));_getLayerIdRef(layerId,ref);desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);executeAction(charIDToTypeID("slct"),desc,_dialogModesNo);}else{ref=new ActionReference();ref.putClass(charIDToTypeID("Path"));_getLayerIdRef(layerId,ref);desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);executeAction(charIDToTypeID("Dslc"),desc,_dialogModesNo);}return layers;};layers.masks.makeRGBActive=function(){var layerId,makeVisible;if(typeof arguments[0]==="number"){layerId=arguments[0];makeVisible=arguments[1]||false;}else{makeVisible=arguments[0]||false;}var ref=new ActionReference();ref.putEnumerated(charIDToTypeID("Chnl"),charIDToTypeID("Chnl"),charIDToTypeID("RGB "));_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putBoolean(charIDToTypeID("MkVs"),makeVisible);executeAction(charIDToTypeID("slct"),desc,_dialogModesNo);return layers;};layers.masks.selectLayerMask=function(layerId){var ref=new ActionReference();ref.putProperty(charIDToTypeID("Chnl"),charIDToTypeID("fsel"));var ref2=new ActionReference();ref2.putEnumerated(charIDToTypeID("Chnl"),charIDToTypeID("Chnl"),charIDToTypeID("Msk "));_getLayerIdRef(layerId,ref);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putReference(charIDToTypeID("T   "),ref2);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);return layers;};layers.masks.selectVectorMask=function(layerId){var ref=new ActionReference();ref.putProperty(charIDToTypeID("Chnl"),charIDToTypeID("fsel"));var ref2=new ActionReference();ref2.putEnumerated(charIDToTypeID("Path"),charIDToTypeID("Path"),stringIDToTypeID("vectorMask"));_getLayerIdRef(layerId,ref2);var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putReference(charIDToTypeID("T   "),ref2);desc.putInteger(charIDToTypeID("Vrsn"),1);desc.putBoolean(stringIDToTypeID("vectorMaskParams"),true);executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);return layers;};Lifter.layers=layers;}());}).call($.global);