/*!
 * Copyright 2014 Francesco Camarlinghi
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * 	http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;(function(){$.strict=true;var Lifter=this.Lifter=function Lifter(){};var Enumeration=this.Enumeration=function Enumeration(){};Enumeration.fromValue=function(enumeration,value){if(typeof enumeration!=="function"){throw new TypeError(['Invalid enumeration "',enumeration,'".'].join(""));}value=+value||0;var enumKeys=Object.keys(enumeration),enumerator;for(var i=0,n=enumKeys.length;i<n;i++){enumerator=enumeration[enumKeys[i]];if(enumerator.valueOf&&enumerator.valueOf()===value){return enumerator;}}return null;};Enumeration.contains=function(enumeration,value){return Enumeration.fromValue(enumeration,value)!==null;};Enumeration.toArray=function(enumeration){if(typeof enumeration!=="function"){throw new TypeError(['Invalid enumeration "',enumeration,'".'].join(""));}var enumKeys=Object.keys(enumeration),enumKeysLength=enumKeys.length,enumerator,result=[];for(var i=0;i<enumKeysLength;i++){enumerator=enumeration[enumKeys[i]];if(enumerator instanceof Enumerator){result.push(enumerator);}}return result;};var Enumerator=this.Enumerator=function Enumerator(name,value){this.__name=name;this.__value=value;};Enumerator.prototype={toString:function(){return this.__name;},valueOf:function(){return this.__value;},"+":function(operand,rev){return undefined;},"-":function(operand,rev){return undefined;},"*":function(operand,rev){return undefined;},"/":function(operand,rev){return undefined;},"~":function(operand,rev){return undefined;},"===":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()===this.valueOf();},"==":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()==this.valueOf();},"<":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{return this.valueOf()<operand.valueOf();}},"<=":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{if(rev){return this.valueOf()>=operand.valueOf();}else{return this.valueOf()<=operand.valueOf();}}}};var UnitDouble=this.UnitDouble=function UnitDouble(unitType,doubleValue){this.unitType=unitType;this.doubleValue=doubleValue;};UnitDouble.prototype={toString:function(){return this.unitType+" = "+this.doubleValue;},valueOf:function(){return this.doubleValue;},"+":function(operand,rev){return this.doubleValue+operand;},"-":function(operand,rev){return(rev)?operand-this.doubleValue:this.doubleValue-operand;},"*":function(operand,rev){return this.doubleValue*operand;},"/":function(operand,rev){return(rev)?operand/this.doubleValue:this.doubleValue/operand;},"~":function(operand,rev){return undefined;},"===":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()===this.valueOf();},"==":function(operand,rev){return(!operand||!operand.valueOf)?false:operand.valueOf()==this.valueOf();},"<":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{return this.valueOf()<operand.valueOf();}},"<=":function(operand,rev){if(!operand||!operand.valueOf){return undefined;}else{if(rev){return this.valueOf()>=operand.valueOf();}else{return this.valueOf()<=operand.valueOf();}}}};var LayerBounds=this.LayerBounds=function LayerBounds(top,left,bottom,right){this.top=new UnitValue(top,"px");this.left=new UnitValue(left,"px");this.bottom=new UnitValue(bottom,"px");this.right=new UnitValue(right,"px");};LayerBounds.prototype={toString:function(){return[this.top,this.left,this.bottom,this.right].join(", ");},valueOf:function(){return undefined;},"+":function(operand,rev){return undefined;},"-":function(operand,rev){return undefined;},"*":function(operand,rev){return undefined;},"/":function(operand,rev){return undefined;},"~":function(operand,rev){return undefined;},"===":function(operand,rev){return(!operand)?false:(operand.top===this.top&&operand.left===this.left&&operand.bottom===this.bottom&&operand.right===this.right);},"==":function(operand,rev){return operand===this;},"<":function(operand,rev){return undefined;},"<=":function(operand,rev){return undefined;}};var LayerType=this.LayerType=function LayerType(){};LayerType.SETSTART=new Enumerator("LayerType.SETSTART",0);LayerType.SETEND=new Enumerator("LayerType.SETEND",1);LayerType.CONTENT=new Enumerator("LayerType.CONTENT",2);var LayerColor=this.LayerColor=function LayerColor(){};LayerColor.NONE=new Enumerator("LayerColor.NONE",charIDToTypeID("None"));LayerColor.RED=new Enumerator("LayerColor.RED",charIDToTypeID("Rd  "));LayerColor.ORANGE=new Enumerator("LayerColor.ORANGE",charIDToTypeID("Orng"));LayerColor.YELLOW=new Enumerator("LayerColor.YELLOW",charIDToTypeID("Ylw "));LayerColor.GREEN=new Enumerator("LayerColor.GREEN",charIDToTypeID("Grn "));LayerColor.BLUE=new Enumerator("LayerColor.BLUE",charIDToTypeID("Bl  "));LayerColor.VIOLET=new Enumerator("LayerColor.VIOLET",charIDToTypeID("Vlt "));LayerColor.GRAY=new Enumerator("LayerColor.GRAY",charIDToTypeID("Gry "));var LifterBlendMode=this.LifterBlendMode=function LifterBlendMode(){};LifterBlendMode.PASSTHROUGH=new Enumerator("LifterBlendMode.PASSTHROUGH",stringIDToTypeID("passThrough"));LifterBlendMode.NORMAL=new Enumerator("LifterBlendMode.NORMAL",charIDToTypeID("Nrml"));LifterBlendMode.DISSOLVE=new Enumerator("LifterBlendMode.DISSOLVE",charIDToTypeID("Dslv"));LifterBlendMode.DARKEN=new Enumerator("LifterBlendMode.DARKEN",charIDToTypeID("Drkn"));LifterBlendMode.MULTIPLY=new Enumerator("LifterBlendMode.MULTIPLY",charIDToTypeID("Mltp"));LifterBlendMode.COLORBURN=new Enumerator("LifterBlendMode.COLORBURN",charIDToTypeID("CBrn"));LifterBlendMode.LINEARBURN=new Enumerator("LifterBlendMode.LINEARBURN",stringIDToTypeID("linearBurn"));LifterBlendMode.DARKERCOLOR=new Enumerator("LifterBlendMode.DARKERCOLOR",stringIDToTypeID("darkerColor"));LifterBlendMode.LIGHTEN=new Enumerator("LifterBlendMode.LIGHTEN",charIDToTypeID("Lghn"));LifterBlendMode.SCREEN=new Enumerator("LifterBlendMode.SCREEN",charIDToTypeID("Scrn"));LifterBlendMode.COLORDODGE=new Enumerator("LifterBlendMode.COLORDODGE",charIDToTypeID("CDdg"));LifterBlendMode.LINEARDODGE=new Enumerator("LifterBlendMode.LINEARDODGE",stringIDToTypeID("linearDodge"));LifterBlendMode.LIGHTERCOLOR=new Enumerator("LifterBlendMode.LIGHTERCOLOR",stringIDToTypeID("lighterColor"));LifterBlendMode.OVERLAY=new Enumerator("LifterBlendMode.OVERLAY",charIDToTypeID("Ovrl"));LifterBlendMode.SOFTLIGHT=new Enumerator("LifterBlendMode.SOFTLIGHT",charIDToTypeID("SftL"));LifterBlendMode.HARDLIGHT=new Enumerator("LifterBlendMode.HARDLIGHT",charIDToTypeID("HrdL"));LifterBlendMode.VIVIDLIGHT=new Enumerator("LifterBlendMode.VIVIDLIGHT",stringIDToTypeID("vividLight"));LifterBlendMode.LINEARLIGHT=new Enumerator("LifterBlendMode.LINEARLIGHT",stringIDToTypeID("linearLight"));LifterBlendMode.PINLIGHT=new Enumerator("LifterBlendMode.PINLIGHT",stringIDToTypeID("pinLight"));LifterBlendMode.HARDMIX=new Enumerator("LifterBlendMode.HARDMIX",stringIDToTypeID("hardMix"));LifterBlendMode.DIFFERENCE=new Enumerator("LifterBlendMode.DIFFERENCE",charIDToTypeID("Dfrn"));LifterBlendMode.EXCLUSION=new Enumerator("LifterBlendMode.EXCLUSION",charIDToTypeID("Xclu"));LifterBlendMode.SUBTRACT=new Enumerator("LifterBlendMode.SUBTRACT",stringIDToTypeID("blendSubtraction"));LifterBlendMode.DIVIDE=new Enumerator("LifterBlendMode.DIVIDE",stringIDToTypeID("blendDivide"));LifterBlendMode.HUE=new Enumerator("LifterBlendMode.HUE",charIDToTypeID("H   "));LifterBlendMode.SATURATION=new Enumerator("LifterBlendMode.SATURATION",charIDToTypeID("Strt"));LifterBlendMode.COLOR=new Enumerator("LifterBlendMode.COLOR",charIDToTypeID("Clr "));LifterBlendMode.LUMINOSITY=new Enumerator("LifterBlendMode.LUMINOSITY",charIDToTypeID("Lmns"));LifterBlendMode.fromBlendMode=function(blendMode){return LifterBlendMode[String(blendMode).replace(/BlendMode\./,"")];};LifterBlendMode.toBlendMode=function(lifterBlendMode){return eval(lifterBlendMode.toString().replace(/LifterBlendMode/,"BlendMode"));};var _dialogModesNo=DialogModes.NO;function _getDescriptorProperty(desc,key,type){type||(type=desc.getType(key));switch(type){case DescValueType.ALIASTYPE:return desc.getPath(key);case DescValueType.BOOLEANTYPE:return desc.getBoolean(key);case DescValueType.CLASSTYPE:return desc.getClass(key);case DescValueType.DOUBLETYPE:return desc.getDouble(key);case DescValueType.ENUMERATEDTYPE:return{type:desc.getEnumerationType(key),value:desc.getEnumerationValue(key)};case DescValueType.INTEGERTYPE:return desc.getInteger(key);case DescValueType.LISTTYPE:return desc.getList(key);case DescValueType.OBJECTTYPE:return{type:desc.getObjectType(key),value:desc.getObjectValue(key)};case DescValueType.RAWTYPE:return desc.getData(key);case DescValueType.REFERENCETYPE:return desc.getReference(key);case DescValueType.STRINGTYPE:return desc.getString(key);case DescValueType.UNITDOUBLE:return new UnitDouble(desc.getUnitDoubleType(key),desc.getUnitDoubleValue(key));default:throw new Error(['Unsupported descriptor value type: "',type,'".'].join(""));}}function _getWrappedActionDescriptor(desc,props,id){var fn=function(desc,props,id,name,value){if(!props.hasOwnProperty(name)){throw new Error(['Invalid property: "',name,'".'].join(""));}var prop=props[name];if(typeof value==="undefined"){if(prop.get){return prop.get.call(null,prop,id,desc);}else{return _getDescriptorProperty(desc,prop.typeId,prop.type);}}else{if(!prop.set){throw new Error(['Property "',name,'" is read-only.'].join(""));}prop.set.call(null,prop,id,value);}};return{innerDescriptor:desc,prop:fn.bind(null,desc,props,id)};}function _byteToPercent(value){return(value/255)*100;}function _find(collection,findType,patterns,context){function __match(id){for(var j=0;j<keysLength;j++){if(patterns[keys[j]]!==collection.prop(id,keys[j])){return false;}}found.push(id);return true;}if(typeof patterns!=="function"){if(typeof patterns!=="object"){throw new Error("Search patterns must be either a function or an object.");}var found=[],keys=Object.keys(patterns),keysLength=keys.length;switch(findType){case 2:collection.forEach(function(itemIndex,id){if(__match.call(null,id)){return true;}},null,true);return found.length?found[0]:null;case 1:collection.forEach(function(itemIndex,id){if(__match.call(null,id)){return true;}},null);return found.length?found[0]:null;default:collection.forEach(function(itemIndex,id){__match.call(null,id);},null);return found;}}else{collection.forEach(patterns,context);}}function _ensureFile(file){if(!(file instanceof File)){file=new File(file);}if(!file.exists){throw new Error(['The specified file does not exists: "',file,'".'].join(""));}return file;}Array.prototype.forEach=Array.prototype.forEach||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t){callback.call(context,t[i],i,t);}}};Array.prototype.every=Array.prototype.every||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t&&!callback.call(context,t[i],i,t)){return false;}}return true;};Array.prototype.some=Array.prototype.some||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t&&callback.call(context,t[i],i,t)){return true;}}return false;};Array.prototype.map=Array.prototype.map||function(callback){if(this===void 0||this===null){throw new TypeError();}var t=Object(this),n=t.length>>>0;if(typeof callback!=="function"){throw new TypeError("callback must be a function.");}var res=new Array(n),context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t){res[i]=callback.call(context,t[i],i,t);}}return res;};Array.prototype.indexOf=Array.prototype.indexOf||function(searchElement){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),length=t.length>>>0,fromIndex=arguments.length>=2?+arguments[1]:0;if(Math.abs(fromIndex)===Infinity){fromIndex=0;}if(fromIndex<0){fromIndex+=length;if(fromIndex<0){fromIndex=0;}}for(;fromIndex<length;fromIndex++){if(t[fromIndex]===searchElement){return fromIndex;}}return -1;};Array.prototype.lastIndexOf=Array.prototype.lastIndexOf||function(searchElement){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined.');}var n,k,t=Object(this),len=t.length>>>0;if(len===0){return -1;}n=len;if(arguments.length>1){n=Number(arguments[1]);if(n!=n){n=0;}else{if(n!=0&&n!=(1/0)&&n!=-(1/0)){n=(n>0||-1)*Math.floor(Math.abs(n));}}}for(k=n>=0?Math.min(n,len-1):len-Math.abs(n);k>=0;k--){if(k in t&&t[k]===searchElement){return k;}}return -1;};Array.prototype.filter=Array.prototype.filter||function(callback){if(this===void 0||this===null){throw new TypeError('"this" is null or not defined.');}var t=Object(this),n=t.length>>>0;if(typeof callback!="function"){throw new TypeError("callback must be a function.");}var res=[],context=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t){var val=t[i];if(callback.call(context,val,i,t)){res.push(val);}}}return res;};Array.prototype.reduce=Array.prototype.reduce||function(callback){if(this===null||typeof this==="undefined"){throw new TypeError("Array.prototype.reduce called on null or undefined.");}if(typeof callback!=="function"){throw new TypeError(callback+" is not a function");}var t=Object(this),len=t.length>>>0,k=0,value;if(arguments.length>=2){value=arguments[1];}else{while(k<len&&!k in t){k++;}if(k>=len){throw new TypeError("Reduce of empty array with no initial value.");}value=t[k++];}for(;k<len;k++){if(k in t){value=callback(value,t[k],k,t);}}return value;};Array.prototype.reduceRight=Array.prototype.reduceRight||function(callback){if(this===null||typeof this==="undefined"){throw new TypeError("Array.prototype.reduce called on null or undefined.");}if(typeof callback!=="function"){throw new TypeError(callback+" is not a function.");}var t=Object(this),len=t.length>>>0,k=len-1,value;if(arguments.length>=2){value=arguments[1];}else{while(k>=0&&!k in t){k--;}if(k<0){throw new TypeError("Reduce of empty array with no initial value.");}value=t[k--];}for(;k>=0;k--){if(k in t){value=callback(value,t[k],k,t);}}return value;};Object.keys=Object.keys||(function(){var hasOwnProperty=Object.prototype.hasOwnProperty;return function(obj){if(typeof obj!=="object"&&(typeof obj!=="function"||obj===void 0||obj===null)){throw new TypeError("Object.keys called on non-object");}var result=[],prop;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop);}}return result;};}());Function.prototype.bind=Function.prototype.bind||function(){if(typeof this!=="function"){throw new TypeError('"this" is not callable.');}var args=Array.prototype.slice.call(arguments,1),toBind=this,noOp=function(){},bound=function(){return toBind.apply(this instanceof noOp&&oThis?this:oThis,args.concat(Array.prototype.slice.call(arguments)));};noOp.prototype=this.prototype;bound.prototype=new noOp();return bound;};Object.prototype.extend=Object.prototype.extend||function(){if(this===null||typeof this==="undefined"){throw new TypeError("Object.prototype.extend called on null or undefined.");}if(arguments.length===0){return this;}var sources=Array.prototype.slice.call(arguments),source,prop,i,length=sources.length;for(i=0;i<length;i++){source=sources[i];for(prop in source){if(source.hasOwnProperty(prop)){this[prop]=source[prop];}}}};Object.prototype.defaults=Object.prototype.defaults||function(){if(this===null||typeof this==="undefined"){throw new TypeError("Object.prototype.defaults called on null or undefined.");}if(arguments.length===0){return this;}var sources=Array.prototype.slice.call(arguments),source,prop,i,length=sources.length;for(i=0;i<length;i++){source=sources[i];for(prop in source){if(source.hasOwnProperty(prop)&&typeof this[prop]==="undefined"){this[prop]=source[prop];}}}};Object.prototype.clone=function(){var copy={};for(var attr in this){if(typeof this[attr]!=="object"){copy[attr]=this[attr];}else{if(this[attr]===this){copy[attr]=copy;}else{copy[attr]=this[attr].clone();}}}return copy;};Array.prototype.clone=function(){var copy=[];for(var i=0,n=this.length;i<n;i++){if(typeof this[i]!=="object"){copy[i]=this[i];}else{if(this[i]===this){copy[i]=copy;}else{copy[i]=this[i].clone();}}}return copy;};Date.prototype.clone=function(){var copy=new Date();copy.setTime(this.getTime());return copy;};Number.prototype.clone=Boolean.prototype.clone=String.prototype.clone=function(){return this;};(function(){var selection={};selection.selectAll=function(){var ref=new ActionReference();ref.putProperty(charIDToTypeID("Chnl"),charIDToTypeID("fsel"));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putEnumerated(charIDToTypeID("T   "),charIDToTypeID("Ordn"),charIDToTypeID("Al  "));executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);return selection;};selection.copy=function(merged){if(merged){executeAction(charIDToTypeID("CpyM"),undefined,_dialogModesNo);}else{executeAction(charIDToTypeID("copy"),undefined,_dialogModesNo);}return selection;};selection.paste=function(){var desc=new ActionDescriptor();desc.putEnumerated(charIDToTypeID("AntA"),charIDToTypeID("Annt"),charIDToTypeID("Anno"));executeAction(charIDToTypeID("past"),desc,_dialogModesNo);return selection;};selection.pasteInto=function(){var desc=new ActionDescriptor();desc.putEnumerated(charIDToTypeID("AntA"),charIDToTypeID("Annt"),charIDToTypeID("Anno"));executeAction(charIDToTypeID("PstI"),desc,_dialogModesNo);return selection;};selection.pasteOutside=function(){var desc=new ActionDescriptor();desc.putEnumerated(charIDToTypeID("AntA"),charIDToTypeID("Annt"),charIDToTypeID("Anno"));executeAction(charIDToTypeID("PstO"),desc,_dialogModesNo);return selection;};selection.pasteToNewDocument=function(name){var desc=new ActionDescriptor();desc.putString(stringIDToTypeID("preset"),"Clipboard");if(typeof name==="string"&&name.length){desc3.putString(charIDToTypeID("Nm  "),name);}var desc2=new ActionDescriptor();desc2.putObject(charIDToTypeID("Nw  "),charIDToTypeID("Dcmn"),desc);executeAction(charIDToTypeID("Mk  "),desc2,_dialogModesNo);selection.paste();if(Lifter.documents){Lifter.documents.flatten();}return this;};selection.clear=function(){executeAction(charIDToTypeID("Dlt "),undefined,_dialogModesNo);return selection;};selection.deselect=function(){var ref=new ActionReference();ref.putProperty(charIDToTypeID("Chnl"),charIDToTypeID("fsel"));var desc=new ActionDescriptor();desc.putReference(charIDToTypeID("null"),ref);desc.putEnumerated(charIDToTypeID("T   "),charIDToTypeID("Ordn"),charIDToTypeID("None"));executeAction(charIDToTypeID("setd"),desc,_dialogModesNo);return selection;};Lifter.selection=selection;}());}).call($.global);